# The Story of the Smart Shelf

Imagine walking into a supermarket. You pass by rows of neatly arranged prod-  
ucts—boxes, bottles, bags—all competing for your attention. You pick up a snack,  
check the ingredients, and then put it back. Maybe you grab another brand, compare  
prices, and finally make your choice.  
From a shopper’s perspective, it’s a routine decision. But from the store’s point of  
view, all that valuable interaction is invisible. Traditional retail systems only record  
what you buy, not what you touched, considered, or almost bought. This missing  
information is a blind spot in retail analytics.  
 
This is where the Smart Shelf comes in—a shelf that doesn’t just hold products  
but senses them being touched or picked up. It’s like giving the shelf a pair of invisible  
hands and ears, enabling it to quietly observe how people interact with products in  
real time.  

## 1.1 What is SFCS?

Capacitive sensing is a method that detects the presence of conductive objects—like  
the human hand—by measuring changes in electrical capacitance. It’s the same prin-  
ciple that makes your phone screen respond to your touch.  
Now, most traditional systems use a fixed frequency to sense touch. That works  
fine for simple applications, but it struggles when there’s electrical noise or when you  
need to detect more subtle gestures like hovering, gripping, or brushing.  
SFCS, or Swept Frequency Capacitive Sensing, takes this to the next level.  
Instead of operating at a single frequency, SFCS sweeps through a range of fre-  
quencies. Think of it like tuning an old radio—not just listening to one station,  
but scanning across many to get a richer picture of what’s out there. When a hand  
touches or nears a surface, it changes the capacitive response in a way that varies with  
frequency. This ”signature” gives us much more information than a single frequency  
could.  

## 1.2 How the Smart Shelf Works?

The Smart Shelf uses a Raspberry Pi Pico 2 to read signals from capacitive touch  
plates embedded under the shelf. These plates are excited with signals generated by  
an AD9850 DDS module, which sweeps across multiple frequencies. When a customer  
interacts with a product, the capacitance changes, and the voltage shifts are captured  
by the Pico’s ADC (Analog-to-Digital Converter).  
These changes can be interpreted as:  
- A touch  
- A hand hover  
- A product being picked up or put down  

## Problem Statement

In contemporary retail environments such as supermarkets, convenience stores, and  
shopping malls, the majority of consumer analytics systems focus solely on final trans-  
actions, capturing only what customers purchase. However, these systems fail to ob-  
serve the intermediate actions that occur during product selection—such as touching,  
picking up, examining, or putting back items. These micro-interactions offer valuable  
insights into consumer behavior, product appeal, pricing sensitivity, and decision-  
making patterns, but remain largely unrecorded and underutilized.  
The absence of such fine-grained interaction data limits retailers’ ability to:  
- Optimize product placement and shelf layout  
- Understand customer intent and engagement  
- Tailor personalized marketing strategies  
- Improve the in-store shopping experience  

Current methods to gather this type of information, such as video surveillance, intro-  
duce challenges related to privacy, cost, and scalability.  
To bridge this gap, there is a need for a low-cost, privacy-preserving, and scalable  
system capable of detecting real-time physical interactions with shelf items.  
This thesis addresses this challenge by proposing a Smart Shelf System based on  
Swept Frequency Capacitive Sensing (SFCS). The system employs Raspberry Pi Pico  
2 and an AD9850 signal generator to detect changes in local capacitance caused by  
human touch. Through this method, the system can monitor user interactions with  
high temporal resolution, enabling retailers to capture previously invisible data at the  
shelf level—thus transforming passive shelves into intelligent, interactive surfaces.  

## 2.1 What We Have Done?

To address this challenge, a working prototype of a Smart Shelf System has been  
designed and implemented. The prototype uses:  
- A Raspberry Pi Pico 2 microcontroller for sensing and processing,  
- An AD9850 Direct Digital Synthesizer to generate a swept frequency signal,  
- A custom capacitive touch grid embedded in the shelf,  
- A signal conditioning circuit to ensure clean data input.  

This hardware setup allows the system to detect real-time touch and proximity ges-  
tures when a customer interacts with products on a shelf.  

## 2.2 The Proposed Solution

The core solution is based on Swept Frequency Capacitive Sensing (SFCS), a tech-  
nique that sweeps through a range of frequencies to analyze how capacitance changes  
with human interaction. Unlike traditional fixed-frequency capacitive sensors, SFCS  
captures more detailed information, enabling accurate detection of:  
- Touch events  
- Hover gestures  
- Product pick-up and put-down actions  

This low-cost and privacy-preserving smart shelf system enables retailers to:  
- Monitor customer interactions directly at the shelf level  
- Gain insights into product engagement without using cameras  
- Optimize product placement and shelf design  
- Improve the overall customer experience  

## State of the Art

### 3.1 Capacitive Sensing Technology

Capacitive sensing is a non-mechanical method to detect touch, proximity, or gestures  
by measuring variations in capacitance caused by conductive objects such as human  
hands. It has emerged as a lightweight and efficient approach for embedding inter-  
activity into everyday objects. Capacitive sensors detect the presence or movement  
of conductive materials, making them widely applicable in touchscreens, wearable  
devices, and smart environments.  
Traditional capacitive touch sensing systems use a fixed frequency to detect changes  
in electric fields. However, this can limit the range of detectable gestures or varia-  
tions in environmental noise. Recent advancements have focused on dynamic or  
multi-frequency techniques that improve robustness, sensitivity, and resolution.  

### 3.2 Swept Frequency Capacitive Sensing (SFCS)

Swept Frequency Capacitive Sensing is an enhancement of classical capacitive sensing,  
where the system dynamically sweeps through a range of frequencies rather than  
operating at a fixed point. This enables the system to analyze how the capacitive  
properties of an object or environment respond across multiple frequencies.  
The key advantage of SFCS lies in its ability to capture richer signal characteris-  
tics. The impedance of a capacitive interface changes with frequency, and analyzing  
this profile—called the capacitive profile—enables more accurate detection of touch,  
grasp, and gestures. For instance, skin contact, pinch grip, or proximity interactions  
can produce unique signatures when observed over a frequency sweep.  

The Touch´e system developed by Disney Research is one of the most cited early  
implementations of SFCS. It allowed recognition of nuanced hand gestures, even un-  
derwater interaction, using a single sensing electrode. By sweeping frequencies from  
1 kHz to 3.5 MHz, the system could classify complex interactions using machine  
learning.  

### 3.3 Applications of SFCS in Human-Computer Interaction

Capacitive sensing, especially when combined with swept frequency methods, has  
opened doors for diverse applications. Some notable use-cases include:  
- Touch-sensitive objects: Everyday items like doorknobs, furniture, or kitchen  
appliances can become interactive using embedded electrodes and SFCS. The  
grasping style—tight grip, pinch, or tap—can be mapped to specific commands  
(e.g., locking doors or triggering alerts).  
- On-body sensing: Worn devices such as bracelets or wristbands can detect  
gestures by observing capacitive variations across the body. For example, touch-  
ing one’s shoulder versus waist produces distinct frequency responses, enabling  
gesture-based controls without cameras.  
- Touchscreen enhancement: Standard capacitive touchscreens can be ex-  
tended to recognize multi-finger gestures, hand postures, or even interactions  
through thin materials like gloves or liquids.  

### 3.4 Smart Shelf Systems and Retail Technology

In the retail domain, shelves are a largely untapped surface for data collection. Tra-  
ditional systems only log the final purchase, ignoring valuable data like customer  
hesitation, product comparison, or partial engagement. This missing data could in-  
form shelf optimization, marketing strategies, and personalized recommendations.  
Smart shelves aim to bridge this gap by integrating sensors, cameras, or RFID  
to detect interactions. However, many of these technologies are either too expensive,  
privacy-invasive, or fragile in crowded retail settings.  

Capacitive touch sensing offers a scalable and cost-effective solution. By embed-  
ding conductive touch plates into shelves and combining them with microcontrollers  
like the Raspberry Pi Pico 2 and signal generators like AD9850, it becomes possible  
to detect real-time interactions with products. Swept frequency sensing enhances  
the accuracy and robustness of this system by filtering out environmental noise and  
enabling gesture recognition.  

### 3.5 Signal Generation and Conditioning

The AD9850 is a Direct Digital Synthesis (DDS) module capable of generating precise  
sine and square waves across a wide frequency range. It is ideal for SFCS applications  
due to its high stability and small form factor. When interfaced with a microcontroller  
such as the Raspberry Pi Pico 2, it can be programmed to sweep through frequencies  
and feed the resulting wave into the sensing circuit.  
Signal conditioning is crucial for accurate detection. The raw signal is typically  
filtered, amplified, and clamped to protect the ADC input. Touch events are detected  
as voltage drops, which are then sampled by the microcontroller’s ADC and analyzed  
for characteristic changes.  

## How the System Works

### 1. Signal Generation (AD9850 Module)

The AD9850 generates a square wave which is fed to the touch plate.  

It is controlled via 4 GPIO pins of the Pico:  
- GPIO2 (W_CLK) – Word Clock Input  
- GPIO3 (FQ_UD) – Frequency Update  
- GPIO4 (D7) – Serial Data Input  
- GPIO5 (RESET) – Resets AD9850  

The output square wave (pin 14, QOUT) is sent through the conditioning circuit to the touch plate.  

### 2. Signal Conditioning

The square wave passes through a filtering network:  
- R1 (10k) limits current.  
- C2 (40nF), C1 (0.1µF), and R2 (3.3k) smooth the signal.  
- D1 provides clamping to avoid overvoltage.  
- L1 (inductor) helps suppress noise or smooth spikes.  

### 3. Touch Detection

The touch plate is connected to this circuit.  
When a human touches a grid (G1–G10), capacitance changes, which causes a voltage drop on the signal line.  
The Pico reads this voltage via ADC2 (GPIO 28).  
Touch leads to a voltage drop at R1 (10k) from 2.3V to 0.3–0.7V.  
